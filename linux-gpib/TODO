cleanup and improve organization of code

ZIATECH support appears to be broken.

